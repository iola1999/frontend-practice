## Vue 的细节

[https://mp.weixin.qq.com/s/gdJWm5Jj1_YhpMUjlfcBVg](https://mp.weixin.qq.com/s/gdJWm5Jj1_YhpMUjlfcBVg)

Vue.js 的响应式系统依赖三个重要的概念，Observer、Dep、Watcher

- 发布者-Observer

  Observe 扮演的角色是发布者，他的主要作用是在组件 vm 初始化的时，调用 defineReactive 函数，使用 Object.defineProperty 方法对对象的每一个子属性进行数据劫持/监听。

  即为每个属性添加 getter 和 setter，将对应的属性值变成响应式。

- 调度中心/订阅器-Dep

  Dep 扮演的角色是调度中心/订阅器，在调用 defineReactive 将属性值变成响应式的过程中，也为每个属性值实例化了一个 Dep，主要作用是对观察者（Watcher）进行管理，收集观察者和通知观察者目标更新。

  即当属性值数据发生改变时，会遍历观察者列表（dep.subs），通知所有的 watcher，让订阅者执行自己的 update 逻辑。

- 观察者-Watcher

  Watcher 扮演的角色是订阅者/观察者，他的主要作用是为观察属性提供回调函数以及收集依赖，当被观察的值发生变化时，会接收到来自调度中心 Dep 的通知，从而触发回调函数。

  而 Watcher 又分为三类，normal-watcher、 computed-watcher、 render-watcher。

  这三种Watcher也有固定的执行顺序，分别是：computed-render -> normal-watcher -> render-watcher。这样就能尽可能的保证，在更新组件视图的时候，computed
  属性已经是最新值了，如果 render-watcher 排在 computed-render 前面，就会导致页面更新的时候 computed 值为旧数据。

## 如果不同 route 使用同一个组件

切换路由时并不会触发 beforeDestory 或者重新触发 created 等
